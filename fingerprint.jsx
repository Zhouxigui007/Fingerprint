// Visual Fingerprint// 
// Ian Wojtowicz// http://wojtowicz.comrnd.today=new Date();var gleaningPercentage = prompt("What percent of each file's content do you want to copy?", '0.01');if (gleaningPercentage == '' || gleaningPercentage == null || gleaningPercentage <= 0){ 	gleaningPercentage = 0.01}else if (gleaningPercentage > 100){	gleaningPercentage = 100;}if (confirm("Render the same image every time?")){	rnd.seed=10;}else{	rnd.seed=rnd.today.getTime();}try{	app.userInteractionLevel = UserInteractionLevel.DONTDISPLAYALERTS; 		collageDocument = documents.add();		alert ("On the next screen, please select a directory to start your image search in.");		var rootFolder = Folder.selectDialog();		var pdfOptions = app.preferences.PDFFileOptions;	pdfOptions.pageToOpen = 1;		recurviselyParseFilesAndPlaceGraphics(rootFolder);		 // recurse and build the collageDocument    rs = "OK";}catch (err){   rs = ("ERROR: " + (err.number & 0xFFFF) + ", " + err.description);   alert(rs);}function recurviselyParseFilesAndPlaceGraphics(folder){	var files = folder.getFiles(isIllustratorCompatible);		for (var i = 0; i < files.length; i++)	{		if (getFileTypeSuffix(files[i]) == "pdf")		{			thisDocument = app.open(files[i], DocumentColorSpace.RGB);		}		else		{			thisDocument = app.open(files[i]);		}						for (var j = 0; j < thisDocument.pageItems.length; j++)		{			if (rnd() <= gleaningPercentage)			{				thisDocument.pageItems[j].duplicate(collageDocument, ElementPlacement.PLACEATEND);			}		}		thisDocument.close();	}	var subFolders = folder.getFiles(isAFolder);		for (var i = 0; i < subFolders.length; i++)	{		recurviselyParseFilesAndPlaceGraphics(subFolders[i]);	}}function isAFolder(file){	if (file instanceof Folder)	{		return true;	}	else	{		return false;	}}function isIllustratorCompatible(file){	if (file.name.indexOf (".") > 0 &&		(getFileTypeSuffix(file) == "pdf" ||		  getFileTypeSuffix(file) == "ai" ))	{		return true;	}	else	{		return false;	}}function getFileTypeSuffix(file){	return file.name.substr(file.name.lastIndexOf (".") + 1, 3);}// The Central Randomizer 1.3 (C) 1997 by Paul Houle (houle@msc.cornell.edu)// See:  http://www.msc.cornell.edu/~houle/javascript/randomizer.htmlfunction rnd() {        rnd.seed = (rnd.seed*9301+49297) % 233280;        return rnd.seed/(233280.0);};function rand(number) {        return Math.ceil(rnd()*number);};// end central randomizer. -->rs;